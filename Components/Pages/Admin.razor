@page "/admin"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Roles = "Admin")]
@inject NavigationManager NavigationManager

<PageTitle>Admin Dashboard</PageTitle>

<div class="admin-container">
    <!-- Hero Section -->
    <div class="admin-hero">
        <div class="admin-hero-content">
            <div class="admin-hero-text">
                <h1 class="admin-title">Manage with Commex</h1>
                <p class="admin-subtitle">
                    Learn how to configure and manage the Communication Experience platform,
                    status taxonomies, and user permissions.
                </p>

                <!-- Search Bar -->
                <div class="admin-search">
                    <MudTextField @bind-Value="searchQuery" Placeholder="Ask admin about configuration..."
                        Variant="Variant.Outlined" FullWidth="true" Class="admin-search-field" />
                </div>
            </div>

            <!-- Illustration Area -->
            <div class="admin-hero-graphic">
                <div class="admin-graphic">
                    <svg viewBox="0 0 400 300" class="admin-illustration">
                        <!-- Background -->
                        <defs>
                            <linearGradient id="blueGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#1E40AF;stop-opacity:1" />
                            </linearGradient>
                        </defs>

                        <!-- 3D Box Effect -->
                        <rect x="50" y="50" width="200" height="150" rx="15" fill="url(#blueGradient)"
                            transform="perspective(400px) rotateY(-15deg)" />
                        <rect x="60" y="60" width="180" height="130" rx="10" fill="#ffffff" opacity="0.1" />

                        <!-- Admin Icon Elements -->
                        <circle cx="150" cy="100" r="15" fill="#ffffff" opacity="0.8" />
                        <rect x="120" y="130" width="60" height="8" rx="4" fill="#ffffff" opacity="0.6" />
                        <rect x="130" y="145" width="40" height="6" rx="3" fill="#ffffff" opacity="0.4" />

                        <!-- Settings Gear -->
                        <g transform="translate(280, 80)">
                            <circle cx="0" cy="0" r="25" fill="#F59E0B" opacity="0.9" />
                            <circle cx="0" cy="0" r="12" fill="#ffffff" />
                            <rect x="-3" y="-20" width="6" height="8" fill="#F59E0B" />
                            <rect x="-3" y="12" width="6" height="8" fill="#F59E0B" />
                            <rect x="-20" y="-3" width="8" height="6" fill="#F59E0B" />
                            <rect x="12" y="-3" width="8" height="6" fill="#F59E0B" />
                        </g>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Platform Section -->
    <div class="admin-platform">
        <h2 class="admin-platform-title">Admin Platform</h2>

        <div class="admin-features-grid">
            <!-- Manage Communications (moved to first) -->
            <MudPaper Class="admin-feature-card clickable-card" Elevation="2" 
                @onclick="@(() => NavigationManager.NavigateTo("/admin/manage-communications"))">
                <div class="admin-feature-content">
                    <div class="admin-feature-icon">
                        <MudIcon Icon="@Icons.Material.Filled.Add" Size="Size.Large" Color="Color.Success" />
                    </div>
                    <h3 class="admin-feature-title">Manage Communications</h3>
                    <p class="admin-feature-description">
                        Create new communications for EOBs, EOPs, ID Cards, and other document types.
                    </p>
                    <div class="admin-feature-action">
                        <MudIcon Icon="@Icons.Material.Filled.ArrowForward" Color="Color.Primary" />
                        <span style="margin-left: 8px; color: var(--mud-palette-primary);">Manage Communications</span>
                    </div>
                </div>
            </MudPaper>

            <!-- Status Taxonomy Management -->
            <MudPaper Class="admin-feature-card clickable-card" Elevation="2"
                @onclick="@(() => NavigationManager.NavigateTo("/admin/status-taxonomy"))">
                <div class="admin-feature-content">
                    <div class="admin-feature-icon">
                        <MudIcon Icon="@Icons.Material.Filled.Settings" Size="Size.Large" Color="Color.Primary" />
                    </div>
                    <h3 class="admin-feature-title">Status Taxonomy</h3>
                    <p class="admin-feature-description">
                        Manage communication types and their valid statuses.
                        Configure the status flow for different communication types.
                    </p>
                    <div class="admin-feature-action">
                        <MudIcon Icon="@Icons.Material.Filled.ArrowForward" Color="Color.Primary" />
                        <span style="margin-left: 8px; color: var(--mud-palette-primary);">Configure Statuses</span>
                    </div>
                </div>
            </MudPaper>

            <!-- Member Management -->
            <MudPaper Class="admin-feature-card clickable-card" Elevation="2"
                @onclick="@(() => NavigationManager.NavigateTo("/admin/members"))">
                <div class="admin-feature-content">
                    <div class="admin-feature-icon">
                        <MudIcon Icon="@Icons.Material.Filled.People" Size="Size.Large" Color="Color.Info" />
                    </div>
                    <h3 class="admin-feature-title">Member Management</h3>
                    <p class="admin-feature-description">
                        Manage system members and their information.
                        Add, edit, or deactivate member accounts.
                    </p>
                    <div class="admin-feature-action">
                        <MudIcon Icon="@Icons.Material.Filled.ArrowForward" Color="Color.Primary" />
                        <span style="margin-left: 8px; color: var(--mud-palette-primary);">Manage Members</span>
                    </div>
                </div>
            </MudPaper>

        </div>
    </div>
</div>

@code {
    private string searchQuery = string.Empty;
}

<style>
    .clickable-card {
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .clickable-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0,0,0,0.15) !important;
    }
    
    .admin-feature-action {
        display: flex;
        align-items: center;
        margin-top: 16px;
        font-size: 0.9rem;
    }
</style>